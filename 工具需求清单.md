
# 🧭 JourneyOn 国内旅行版工具实现清单（可直接规划开发）

| 阶段                       | 类别          | 工具名                 | 功能描述                                           | 来源/实现方式                                                                      | 说明与优先级                |
| -------------------------- | ------------- | ---------------------- | -------------------------------------------------- | ---------------------------------------------------------------------------------- | --------------------------- |
| **PreTrip 行前规划** | 🌤 天气       | `OpenWeatherMapTool` | 根据城市名查询天气与温度，为出行时间建议提供依据。 | [OpenWeather API](https://openweathermap.org/api)或[和风天气](https://dev.qweather.com/) | ⭐⭐⭐⭐ 高优先级，行前依赖 |
|                            | 🗺️ 地图/POI | `GaodeMapTool`       | 获取城市景点、路线与地标信息，用于行程草案生成。   | 高德地图开放平台（POI 搜索、路线规划接口）                                         | ⭐⭐⭐⭐ 高优先级           |
|                            | 🏨 酒店       | `HotelSearchTool`    | 根据城市、日期、预算搜索酒店列表。                 | Mock 或 公开数据（携程/去哪儿 API）                                                | ⭐⭐⭐⭐                    |
|                            | ✈️ 航班     | `FlightSearchTool`   | 查询城市间航班与票价，支持出发/返回日期。          | Amadeus API / Trip.com（mock）                                                     | ⭐⭐⭐                      |
|                            | 🚗 出行       | `TransportTool`      | 查询高铁、汽车等交通方式及时间表。                 | 12306 接口模拟 / Mock                                                              | ⭐⭐⭐                      |
|                            | 💡 综合检索   | `DeepSearchTool`     | 结合 Tavily/Serper 执行综合信息检索。              | 已实现 `deep_search.py`                                                          | ✅ 已完成                   |
|                            | 📋 快速搜索   | `FastSearchTool`     | 快速新闻/活动搜索，为旅程提供参考。                | 已实现 `fast_search.py`                                                          | ✅ 已完成                   |

---

| 阶段                      | 类别          | 工具名                | 功能描述                                   | 来源/实现方式              | 说明与优先级 |
| ------------------------- | ------------- | --------------------- | ------------------------------------------ | -------------------------- | ------------ |
| **OnTrip 在途陪伴** | 🌤 天气       | `WeatherUpdateTool` | 实时获取当前位置天气、空气质量、温差提醒。 | 高德天气或和风天气 API     | ⭐⭐⭐⭐     |
|                           | 🗺️ 导航/POI | `NearbyPOITool`     | 获取当前位置附近的景点、美食、活动等信息。 | 高德地图 POI API           | ⭐⭐⭐⭐     |
|                           | 📍 导航       | `RoutePlanTool`     | 计算两地之间的路线与出行时间。             | 高德路线规划 API           | ⭐⭐⭐       |
|                           | 🚨 通知       | `EventAlertTool`    | 实时事件推送（交通封路、天气异常）。       | 新闻/高德事件 API          | ⭐⭐⭐       |
|                           | 📄 信息抽取   | `DeepExtractTool`   | 抽取网页关键信息（如当地政策、节庆活动）。 | 已实现 `deep_extract.py` | ✅ 已完成    |

---

| 阶段                        | 类别          | 工具名                 | 功能描述                                       | 来源/实现方式              | 说明与优先级  |
| --------------------------- | ------------- | ---------------------- | ---------------------------------------------- | -------------------------- | ------------- |
| **PostTrip 行后总结** | 🧠 知识库     | `QdrantSearchTool`   | 在 Qdrant 向量库中执行知识检索与存储。         | 自建 Qdrant 集群（已支持） | ✅ 已内置支持 |
|                             | 📷 总结提取   | `TripSummaryTool`    | 总结行程亮点、问题、偏好标签。                 | 自定义 LLM 调用            | ⭐⭐⭐⭐      |
|                             | 💾 上传归档   | `DocumentUploadTool` | 上传发票/票据/游记到云端或 KB。                | FastAPI 文件上传           | ⭐⭐⭐        |
|                             | 🏷️ 标签抽取 | `PreferenceTagTool`  | 抽取用户偏好标签（如“喜欢美食”“避高温”）。 | LLM prompt 模型            | ⭐⭐⭐⭐      |

---

## ✅ 可直接投入开发的工具（高优先级组）

| 工具名                 | 功能定位           | 对应阶段         | 当前状态  | 实现建议                                             |
| ---------------------- | ------------------ | ---------------- | --------- | ---------------------------------------------------- |
| `GaodeMapTool`       | 景点/路线/地标检索 | PreTrip / OnTrip | 🆕 待实现 | 使用高德 API：`/place/text` `/direction/driving` |
| `OpenWeatherMapTool` | 天气查询与更新     | PreTrip / OnTrip | 🆕 待实现 | 兼容和风天气备用接口                                 |
| `HotelSearchTool`    | 酒店搜索           | PreTrip          | 🆕 待实现 | Mock 数据或携程 OpenAPI                              |
| `FlightSearchTool`   | 航班信息           | PreTrip          | 🆕 待实现 | Mock + 后期接 Amadeus                                |
| `NearbyPOITool`      | 附近景点与餐饮推荐 | OnTrip           | 🆕 待实现 | 高德 POI 周边搜索                                    |
| `RoutePlanTool`      | 路线规划           | OnTrip           | 🆕 待实现 | 高德路径规划（驾车/步行/公交）                       |
| `EventAlertTool`     | 天气/交通异常提醒  | OnTrip           | 🆕 待实现 | 结合天气API与新闻事件                                |
| `TripSummaryTool`    | 行程总结与偏好生成 | PostTrip         | 🆕 待实现 | LLM 调用 + Prompt 模板                               |
| `PreferenceTagTool`  | 偏好抽取           | PostTrip         | 🆕 待实现 | 与 SummaryTool 联动更新 UserTags                     |
| `QdrantSearchTool`   | 知识检索与记忆     | PostTrip         | ✅ 已支持 | 接入 Embedding + Qdrant 集成                         |

---

## 🧩 工具实现层结构建议

```
app/
 ├─ providers/
 │   └─ tools/
 │       ├─ __init__.py
 │       ├─ gaode_map_tool.py
 │       ├─ open_weather_tool.py
 │       ├─ hotel_search_tool.py
 │       ├─ flight_search_tool.py
 │       ├─ nearby_poi_tool.py
 │       ├─ route_plan_tool.py
 │       ├─ event_alert_tool.py
 │       ├─ trip_summary_tool.py
 │       ├─ preference_tag_tool.py
 │       ├─ qdrant_search_tool.py
 │       ├─ fast_search_tool.py     ← 已有
 │       ├─ deep_search_tool.py     ← 已有
 │       └─ deep_extract_tool.py    ← 已有
```

---

## 🚀 实施优先级路线图

| 周期    | 开发目标                       | 工具集合                                                      | 输出                    |
| ------- | ------------------------------ | ------------------------------------------------------------- | ----------------------- |
| 第 1 周 | 核心工具（天气 + 地图 + 酒店） | `OpenWeatherMapTool`、`GaodeMapTool`、`HotelSearchTool` | 行前智能体可独立运行    |
| 第 2 周 | 出行陪伴工具                   | `NearbyPOITool`、`RoutePlanTool`、`EventAlertTool`      | OnTrip 智能体可实时推送 |
| 第 3 周 | 行后总结                       | `TripSummaryTool`、`PreferenceTagTool`                    | PostTrip 智能体生成报告 |
| 第 4 周 | 工具集成与测试                 | 所有工具联调                                                  | 全流程 Trip → KB 写回  |

---

## ✅ 总结（简版）

你现在需要实现的核心工具是：

| 阶段               | 工具列表                                                                                               |
| ------------------ | ------------------------------------------------------------------------------------------------------ |
| **PreTrip**  | `GaodeMapTool`、`OpenWeatherMapTool`、`HotelSearchTool`、`FlightSearchTool`、`TransportTool` |
| **OnTrip**   | `NearbyPOITool`、`RoutePlanTool`、`EventAlertTool`                                               |
| **PostTrip** | `TripSummaryTool`、`PreferenceTagTool`                                                             |

> 这 10 个工具 + 已完成的 3 个检索工具（fast/deep_search/extract）
>
> 就能支撑整个三阶段智能体完整运行闭环。

---

是否希望我帮你把这  **10 个工具的实现模板骨架** （包含类定义、输入参数模型、示例 `_run()` / `_arun()`、注册示例）

生成成一份  **可直接放入 `app/providers/tools/` 的模板包** ？
